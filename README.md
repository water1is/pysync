# PySync - 简易局域网文件同步工具使用文档

## 项目概述

PySync是一个基于Python的简易局域网文件同步工具，允许用户在局域网内的多台计算机之间同步指定文件夹的内容。本项目实现了基本的文件同步功能，并添加了传输进度显示功能以提升用户体验。

## 主要功能

- ✅ 局域网设备自动发现
- ✅ 文件双向同步
- ✅ 基于修改时间的冲突解决
- ✅ 文件传输进度可视化
- ✅ 多线程文件传输

## 计算机网络技术应用

本项目应用了以下计算机网络核心技术：

1. **UDP广播** - 用于局域网设备发现
   - 使用UDP的广播特性自动发现同一局域网内的其他设备
   - 实现原理：定期向`<broadcast>`地址发送广播包

2. **TCP可靠传输** - 用于文件同步
   - 建立TCP连接保证文件传输的可靠性
   - 实现原理：使用Python的`socket`模块创建TCP服务器/客户端

3. **多线程编程** - 实现并发处理
   - 同时处理设备发现、文件传输和用户交互
   - 实现原理：Python的`threading`模块

4. **文件传输协议设计** - 简单的应用层协议
   - 自定义消息格式实现文件列表交换和文件传输
   - 实现原理：JSON格式的消息头 + 二进制文件内容

## 安装与使用

### 环境要求

- Python 3.6+
- 跨平台支持(Windows/macOS/Linux)

### 安装步骤

1. 克隆或下载项目代码
   ```bash
   git clone https://github.com/yourusername/pysync.git
   cd pysync
   ```

2. 安装依赖
   ```bash
   pip install watchdog cryptography  # 如果需要使用文件监控或加密功能
   ```

### 基本使用

1. **启动程序**
   ```bash
   python main.py
   ```

2. **设备发现**
   - 程序会自动扫描局域网内的其他PySync设备
   - 发现的设备会显示在列表中

3. **文件同步**
   - 将需要同步的文件放入`sync_folder`文件夹
   - 在菜单中选择"手动同步所有设备"
   - 观察传输进度条：

     ```
     下载 test.txt (1024 bytes)
     [####################                          ] 40%
     ```

4. **同步规则**
   - 新文件会自动同步到所有设备
   - 当文件冲突时(两边都修改过)，保留最新版本

## 进度显示功能说明

本项目添加了直观的文件传输进度显示：

1. **进度条可视化**：
   - 使用`#`字符表示已完成部分
   - 空白表示剩余部分
   - 百分比数字显示精确进度

2. **显示内容**：
   - 文件名
   - 文件大小
   - 进度条图形
   - 完成百分比

3. **技术实现**：
   ```python
   while received < file_info['size']:
       data = sock.recv(min(config.BUFFER_SIZE, file_info['size'] - received))
       # ...传输数据...
       progress = int(received / file_info['size'] * 50)
       print(f"[{'#'*progress}{' '*(50-progress)}] {int(received/file_info['size']*100)}%", end='\r')
   ```

## 常见问题

Q: 为什么发现不了其他设备？
A: 请确保：
   - 所有设备在同一局域网
   - 防火墙允许Python程序通信
   - 设备都在运行PySync

Q: 文件同步失败怎么办？
A: 尝试：
   - 检查网络连接
   - 重启PySync程序
   - 确认有文件读写权限

## 项目结构

```
pysync/
│── main.py            # 主程序入口
│── network.py         # 网络通信核心
│── file_utils.py      # 文件处理工具
│── config.py          # 配置管理
└── 介绍与使用方法.md          # 使用说明
```

## 扩展建议

1. 添加文件加密功能(使用cryptography库)
2. 实现自动同步(使用watchdog监控文件变化)
3. 增加图形用户界面(Tkinter/PyQt)
4. 支持子目录同步

